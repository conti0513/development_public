
Windows11_Automated_Setup_Guide



# Windows 11 自動セットアップ手順

この手順では、Windows 11 のインストール後にユーザー作成やアプリケーションのインストールを自動化する方法を説明します。

## 1. USB ドライブの準備

まず、以下のファイルとフォルダを USB ドライブに配置します：

```
USB ドライブ
├── create_user.ps1   # ユーザー作成用スクリプト
├── remove_user.ps1   # ユーザー削除用スクリプト
├── setup.ps1         # アプリケーションインストール用スクリプト
├── users.csv         # ユーザー情報を記載した CSV ファイル
├── apps.csv          # アプリケーション情報を記載した CSV ファイル
└── installers        # アプリケーションのインストーラーを格納するフォルダ
```

## 2. users.csv の作成

`users.csv` ファイルには、作成するユーザーの情報を以下の形式で記載します：

```
username,fullname,password
user1,User One,Password1
user2,User Two,Password2
```

## 3. apps.csv の作成

`apps.csv` ファイルには、インストールするアプリケーションの情報を以下の形式で記載します：

```
installer_name,description
app1_installer.exe,App One のインストール
app2_installer.exe,App Two のインストール
```

## 4. スクリプトの実行手順

1. **管理者として PowerShell を実行**：

   スタートメニューから「Windows PowerShell」を右クリックし、「管理者として実行」を選択します。

2. **USB ドライブのディレクトリに移動**：

   例として、USB ドライブが D ドライブの場合、以下のコマンドを実行します：

   ```powershell
   cd D:\
   ```

3. **ユーザー作成スクリプトの実行**：

   ```powershell
   .\create_user.ps1
   ```

   これにより、`users.csv` に記載されたユーザーが作成され、管理者権限が付与されます。

4. **ユーザーの確認**：

   正しくユーザーが作成されたことを確認します。誤りがあった場合は、次の手順でユーザーを削除します。

5. **ユーザー削除スクリプトの実行（必要に応じて）**：

   ```powershell
   .\remove_user.ps1
   ```

   これにより、`users.csv` に記載されたユーザーが削除されます。

6. **正しいユーザー情報で再度ユーザー作成スクリプトを実行**：

   `users.csv` を修正し、再度 `create_user.ps1` を実行してユーザーを作成します。

7. **新しく作成したユーザーでログイン**：

   作成したユーザー（例：`user1`）で Windows にログインします。

8. **アプリケーションインストールスクリプトの実行**：

   新しく作成したユーザーで以下のコマンドを実行します：

   ```powershell
   .\setup.ps1
   ```

   これにより、`apps.csv` に記載されたアプリケーションがインストールされます。

## 5. 注意事項

- スクリプトの実行には管理者権限が必要です。
- アプリケーションのインストーラーは、USB ドライブ内の `installers` フォルダに格納してください。
- `apps.csv` ファイルには、インストーラー名とその説明を正確に記載してください。
- スクリプトの実行中に表示されるメッセージに従って操作を行ってください。 