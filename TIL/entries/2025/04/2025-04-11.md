# ğŸ“˜ TIL: 2025-04-11

I cover both internal IT and cloud architecture.  
I'm confident leading small-scale IT projects end-to-end, and documenting everything in English.  
Currently building a global portfolio for international work opportunities.

---

I handle both hands-on technical troubleshooting and operational IT tasks for multi-site environments.  
Todayâ€™s work focused on both technical billing operations and GCP certification study, reinforcing cross-domain expertise. 

I'm also working on reducing operational technical debt, especially around SaaS operations and internal workflows, with a strong focus on automation, scalability, and long-term maintainability.


## âœ… æˆæœ / Highlights

## ğŸ“˜ TIL: 2025-04-11 â€“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬ç¢ºèªã‚³ãƒãƒ³ãƒ‰  
## ğŸ“˜ TIL: 2025-04-11 â€“ One-Liner to Preview All Files in Directory  

---

### âœ… ä»Šæ—¥ã‚„ã£ãŸã“ã¨ / What I Did  
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ãƒ•ã‚¡ã‚¤ãƒ«åä»˜ãã§ä¸€æ‹¬å‡ºåŠ›ã™ã‚‹ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã‚’ç¢ºèªãƒ»æ´»ç”¨ã—ãŸã€‚  
Reviewed and used a one-liner to output all file contents in a directory with their filenames as headers.

```bash
find . -type f -exec echo "===== {} =====" \; -exec cat {} \;
```

---

### ğŸ’¡ å­¦ã³ / Takeaway  
- ã‚³ãƒãƒ³ãƒ‰1è¡Œã§å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’ç´ æ—©ãç¢ºèªã§ãã¦ä¾¿åˆ©  
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚„æ§‹é€ ãƒã‚§ãƒƒã‚¯ã«æœ€é©  
- Gitã®å·®åˆ†ç¢ºèªã‚„èº«ãƒãƒ¬ãƒã‚§ãƒƒã‚¯ã«ã‚‚å¿œç”¨å¯èƒ½  

This one-liner is great for:
- Quickly checking file contents
- Reviewing documentation structures
- Double-checking for confidential info before commits

---

### ğŸ·ï¸ Tags  
- [x] Linux Command  
- [x] Shell Tips  
- [x] Documentation Review  
- [x] TIL  
- [ ] Automation  

---

## ğŸ“˜ TIL: 2025-04-11 â€“ Gmail CSV è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ  
## ğŸ“˜ TIL: 2025-04-11 â€“ Gmail CSV Auto-Uploader to GCS with Backup  

---

### âœ… ä»Šæ—¥ã‚„ã£ãŸã“ã¨ / What I Did  
Gmailã‹ã‚‰ç‰¹å®šã® `.csv` æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•æŠ½å‡ºã—ã€æœ€æ–°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’GCSã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹GASã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ•´ç†ã€‚  
å¿…è¦ã«å¿œã˜ã¦Google Driveã«å±¥æ­´ã‚’æ®‹ã—ã€GCSã®å¤ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•å‰Šé™¤ã™ã‚‹æ©Ÿèƒ½ã‚‚å«ã‚ãŸã€‚

Created and documented a GAS script that:
- Automatically extracts `.csv` attachments from Gmail (based on subject/filename)
- Uploads the latest one to **Google Cloud Storage (GCS)**
- Optionally backs up to **Google Drive**
- Deletes older files from GCS to retain only the latest

---

### ğŸ’¡ å­¦ã³ / Key Takeaways  
- Apps Script + GCS API ã«ã‚ˆã‚Šã€ã‚³ã‚¹ãƒˆã‚¼ãƒ­ã§å®Ÿç”¨çš„ãªè‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ€ãƒ¼ãŒä½œã‚Œã‚‹  
- æ¯æ™‚èµ·å‹•ã®ãƒˆãƒªã‚¬ãƒ¼ã§é‹ç”¨ã‚‚ç°¡å˜  
- ä¸­å°ä¼æ¥­ã®å–¶æ¥­/çµŒç†CSVãƒ¬ãƒãƒ¼ãƒˆå‡¦ç†ã«å¿œç”¨å¯èƒ½  

By combining GAS and GCS API:
- You can build a cost-free CSV uploader
- Hourly trigger makes it operationally light
- Ideal for automating vendor data intake (e.g. sales, accounting CSVs)

---

### ğŸ·ï¸ Tags  
- [x] Google Apps Script  
- [x] Cloud Automation  
- [x] GCS  
- [x] Gmail API  
- [x] Data Ingestion  
- [ ] Monitoring  

---




## âœ… å…ˆæœˆã®æœ€å¤§æˆæœ / Highlight of the Week

ğŸš€ **Cloud Run + FTPS ã‚’é€£æºã—ãŸã€Œã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«è»¢é€ APIã€æ§‹ç¯‰ã«æˆåŠŸï¼**  
Built a fully automated FTPS transfer API using Cloud Run, supporting static IP and GCS triggers.

---

## ğŸ”§ æ§‹æˆã¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« / Architecture & Modules

```
serverless-ftps-api-public/
â”œâ”€â”€ A_cloudrun-api/      # Cloud Run API + GCS trigger
â”œâ”€â”€ B_ftps-server/       # FTPS server on GCE
â””â”€â”€ C_vpc-networking/    # VPC Connector + NAT for static IP
```

- GCS ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ Cloud Run ãŒèµ·å‹•ã—ã€FTPS ã«è»¢é€ã•ã‚Œã‚‹  
- Static IP ã‚’ Cloud NAT + VPC Connector ã§å®Ÿç¾  
- FTPS ã¯ Passive ãƒ¢ãƒ¼ãƒ‰ã§ã€Firewall ã‚„ãƒãƒ¼ãƒˆãƒ¬ãƒ³ã‚¸ã‚‚èª¿æ•´æ¸ˆã¿

---

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³ / System Diagram

```
[GCS] â”€â”€> [Cloud Run API] â”€â”€> [FTPS Server (GCE)]
               â”‚
      (Static IP via VPC Connector + NAT)
```

---

## ğŸ§ª å®Ÿè¡Œãƒ­ã‚° / Execution Log

```bash
$ bash 03_test_cloud_run.sh

âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº† / File uploaded  
âœ… Cloud Run ç™ºç«ç¢ºèª / Triggered  
âœ… FTPS ã‚µãƒ¼ãƒãƒ¼ã«è»¢é€æˆåŠŸ / File transfer succeeded

Transfer completed:
upload_test_20250323050140.txt -> /home/your_username/upload_test_20250323050140.txt
```

---

## ğŸ§  å­¦ã³ãƒ»æ°—ã¥ã / Learnings & Takeaways

- Cloud Run ã§å¤–éƒ¨ FTPS ã«æ¥ç¶šã™ã‚‹ã«ã¯å›ºå®šIPæ§‹æˆãŒå¿…é ˆ  
  â†’ Static IP configuration is required for Cloud Run to access external FTPS  
- VPC Connector + Cloud NAT ã‚’çµ„ã¿åˆã‚ã›ã¦æ§‹æˆ  
  â†’ Combining VPC Connector and Cloud NAT works well  
- FTPS ã¯ Passive ãƒ¢ãƒ¼ãƒ‰åˆ©ç”¨æ™‚ã« Firewall ã¨ NAT ã®è¨­è¨ˆãŒéµ  
  â†’ Passive mode FTPS requires careful port and firewall design  
- Terraform ã‚’ä½¿ã‚ãªãã¦ã‚‚ã€ã‚·ã‚§ãƒ«ã¨ JSON ã§å†ç¾ã§ããŸ  
  â†’ Infra setup was reproducible with shell + JSON, no Terraform needed

---

## ğŸ“Œ ãã®ä»–é€²æ— / Other Progress

- CloudShell ã‹ã‚‰ zip åŒ–ã—ã¦ Codespaces ã«è»¢é€ãƒ»å±•é–‹å®Œäº†  
  â†’ Zipped files and moved to Codespaces successfully  
- `.gitignore` ã‚’ä½¿ã£ã¦æ®µéšçš„ã«ã‚³ãƒ¼ãƒ‰å…¬é–‹æº–å‚™ä¸­  
  â†’ Using .gitignore to control staged releases  
- GCP ã‚³ã‚¹ãƒˆæœ€å°åŒ–ã®ãŸã‚æ¤œè¨¼ç’°å¢ƒã®ã¿æ§‹ç¯‰  
  â†’ Setup done on a test-only basis to minimize GCP billing

---

## ğŸ”œ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ / Next Steps

- README ã‚’ GitHub ã§å…ˆè¡Œå…¬é–‹äºˆå®š  
  â†’ Start with README release on GitHub  
- SFTP ã‚„ä»–ã‚µãƒ¼ãƒ“ã‚¹é€£æºã«ã‚‚å¿œç”¨å¯èƒ½ã‹æ¤œè¨  
  â†’ Explore SFTP or other system integration  
- Zennã«è¨˜äº‹åŒ–
  â†’ Turn it into a blog post
- ã€Œã‚¯ãƒ©ã‚¦ãƒ‰å®Œçµ Ã— é‹ç”¨ä¸è¦ Ã— å›ºå®šIPã€æ§‹æˆã®äº‹ä¾‹åŒ–  
  â†’ Make this a showcase of â€œserverless + no ops + fixed IPâ€ architecture


---
